YUI.add("hermes-template-search-filter-tools",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='<div class="dropdown-link filter-license"><p class="option-header">',(o=n.license)?o=o.call(t,{hash:{},data:i}):(o=t.license,o=typeof o===u?o.apply(t):o),s+=a(o)+'</p><span class="dropdown-arrow"></span></div>\n<div class="dropdown-link filter-safe-search"><p class="option-header">',(o=n.safeSearch)?o=o.call(t,{hash:{},data:i}):(o=t.safeSearch,o=typeof o===u?o.apply(t):o),s+=a(o)+'</p><span class="dropdown-arrow"></span></div>\n',s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/search-filter-tools",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("search-filter-tools-view",function(e){var t="marketplace",n=[{intlKey:"search.ANY_LICENSE",value:"any",isDefault:!0},{intlKey:"search.MARKETPLACE_LICENSE",value:t,isMarketplaceLicense:!0,itemFlag:"common.NEW"},{intlKey:"search.ALL_CC",value:"2,3,4,5,6,9"},{intlKey:"search.COMMERCIAL_USE",value:"4,5,6,9,10"},{intlKey:"search.MODS_ALLOWED",value:"1,2,9,10"},{intlKey:"search.COMMERCIAL_USE_MODS",value:"4,5,9,10"},{intlKey:"search.NO_RESTRICTIONS",value:"7,9,10",isCommonsLicense:!0},{intlKey:"search.PUBLIC_DOMAIN_DEDICATION",value:"9",notInDropdown:!0},{intlKey:"search.PUBLIC_DOMAIN_WORK",value:"10",notInDropdown:!0},{intlKey:"search.US_GOVT",value:"8"}],r=[{intlKey:"search.SAFESEARCH_ON",value:"1",prefValue:0,isDefault:!0},{intlKey:"search.SAFESEARCH_MODERATE",value:"2",prefValue:1},{intlKey:"search.SAFESEARCH_OFF",value:"3",prefValue:2}];e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){var i=this,s,o,u,a,f,l;return this.searchUrl=t.searchUrl?t.searchUrl.clone():new e.SearchUrl({},this.appContext,e.SearchUrl.searchTypes.PHOTOS),s=this.searchUrl.getAPIParam(e.SearchHelper.API.safeSearch),o=this.searchUrl.getAPIParam(e.SearchHelper.API.license),l=this.searchUrl.getAPIParam(e.SearchHelper.API.commons),o&&(u=e.SearchHelper.deriveCCLicenseString(this.searchUrl.getAPIParams()),u&&this.set("selectedLicenseText",this.intlMessage(u))),this.safeSearches=[],r.forEach(function(t){a=e.merge(t,{text:i.intlMessage({intlName:t.intlKey})}),s?a.value===s&&(i.set("selectedSafeSearch",a.value),i.set("selectedSafeSearchText",a.text),i.usedAPISafeSearch=!0):a.isDefault&&(i.set("selectedSafeSearch",a.value),i.set("selectedSafeSearchText",a.text)),i.safeSearches.push(a)}),this.licenses=[],n.forEach(function(t){f=e.merge(t,{text:i.intlMessage({intlName:t.intlKey})}),t.itemFlag&&(f.itemFlag=i.intlMessage({intlName:t.itemFlag})),o?f.value===o&&(i.set("selectedLicense",f.value),i.set("selectedLicenseText",f.text)):l==="true"||parseInt(l)?f.isCommonsLicense&&(i.set("selectedLicense",f.value),i.set("selectedLicenseText",f.text)):f.isMarketplaceLicense?i.appContext.flipper.isFlipped("display-marketplace-licensable")?parseInt(i.searchUrl.getAPIParam(e.SearchHelper.API.marketplace))&&(i.set("selectedLicense",f.value),i.set("selectedLicenseText",f.text)):f=null:f.isDefault&&(i.set("selectedLicense",f.value),i.set("selectedLicenseText",f.text)),f&&!f.notInDropdown&&i.licenses.push(f)}),this},loadState:function(){var t=this,n=[];return this.appContext.getViewer().signedIn&&n.push(this.appContext.getModel("person-preferences-models",this.appContext.getViewer().nsid).then(function(e){t.set("viewerPrefsModel",e),t.safeSearches.forEach(function(n){n.isDefault=!1,n.prefValue===e.getValue("safeSearch")&&(t.usedAPISafeSearch||(t.set("selectedSafeSearch",n.value),t.set("selectedSafeSearchText",n.text)),n.isDefault=!0)})})),e.Promise.all(n)},buildContainer:function(){return this.setContainerHTML(this.templates("search-filter-tools")({license:this.get("selectedLicenseText"),safeSearch:this.get("selectedSafeSearchText")})),this},activate:function(){return this.registerEventHandler(this.get("container").one(".filter-license").on("click",this.handleFilterLicense.bind(this))),this.registerEventHandler(this.get("container").one(".filter-safe-search").on("click",this.handleFilterSafeSearch.bind(this))),this},handleFilterLicense:function(t){var n=this;t.halt(),this.dropdown=new e.Views.FluidDroparound({appContext:this.appContext,showDropArrow:!0,observePageResize:!0,anchorElement:t.target.one(".dropdown-arrow"),positionFixed:!0,closeOnScroll:!0,preferBottom:!0,contentPadding:12,anchorOffsetHorizontal:t.target.get("clientWidth")-12,menuItems:this.licenses}),this.dropdown.show(),this.registerEventHandler(this.dropdown.on("selected",function(e){e&&e.menuItem&&e.menuItem.value!==n.get("selectedLicense")&&(n.set("selectedLicense",e.menuItem.value),n.set("selectedLicenseText",e.menuItem.text),n.get("container").one(".filter-license p").set("text",n.get("selectedLicenseText")),n.processUpdate()),n.dropdown.close()}))},handleFilterSafeSearch:function(t){var n=this;t.halt(),this.dropdown=new e.Views.FluidDroparound({appContext:this.appContext,showDropArrow:!0,observePageResize:!0,anchorElement:t.target.one(".dropdown-arrow"),positionFixed:!0,closeOnScroll:!0,preferBottom:!0,contentPadding:12,anchorOffsetHorizontal:t.target.get("clientWidth")-12,menuItems:this.safeSearches}),this.dropdown.show(),this.registerEventHandler(this.dropdown.on("selected",function(e){if(e&&e.menuItem){if(!this.appContext.getViewer().signedIn&&(parseInt(e.menuItem.value,10)===2||parseInt(e.menuItem.value,10)===3)&&this.appContext.flipper.isFlipped("enable-signed-out-cta-test")){n.showSignUpModal(),n.dropdown.close();return}n.set("selectedSafeSearch",e.menuItem.value),n.set("selectedSafeSearchText",e.menuItem.text),n.get("container").one(".filter-safe-search p").set("text",n.get("selectedSafeSearchText")),n.processUpdate()}n.dropdown.close()}))},processUpdate:function(){this.isDefaultLicenseValue()?(this.searchUrl.removeAPIParam(e.SearchHelper.API.license),this.searchUrl.removeAPIParam(e.SearchHelper.API.marketplace)):this.get("selectedLicense")===t?(this.searchUrl.removeAPIParam(e.SearchHelper.API.license),this.searchUrl.setAPIParam(e.SearchHelper.API.marketplace,"1")):(this.searchUrl.setAPIParam(e.SearchHelper.API.license,this.get("selectedLicense")),this.searchUrl.removeAPIParam(e.SearchHelper.API.marketplace)),this.isDefaultSafeSearchValue()?this.searchUrl.removeAPIParam(e.SearchHelper.API.safeSearch):this.searchUrl.setAPIParam(e.SearchHelper.API.safeSearch,this.get("selectedSafeSearch")),this.fire("subviewViewEvent","search:urlUpdate",this.searchUrl)},isDefaultLicenseValue:function(){var e=this;return this.licenses.reduce(function(t,n){return t||n.isDefault&&n.value===e.get("selectedLicense")},!1)},isDefaultSafeSearchValue:function(){var e=this;return this.safeSearches.reduce(function(
t,n){return t||n.isDefault&&n.value===e.get("selectedSafeSearch")},!1)},showSignUpModal:function(){var t=e.config.win.location.href,n=this.intlMessage({intlName:"search.SIGN_IN_BEFORE_SEARCH_TITLE"}),r=this.intlMessage({intlName:"search.SIGN_IN_BEFORE_SEARCH_MESSAGE"}),i;i=new e.Views.SignUpModal({appContext:this.appContext,signUpHeaderClass:"signup-search-mature",signUpTitle:n,signUpMessage:r,beaconPrefix:"searchFilter"}),i.on("signUpClick",function(n){e.SigninHelper._redirectToSignUp("",{postLoginUrl:t})}),i.on("signInClick",function(n){e.SigninHelper._redirectToSignin("",{postLoginUrl:t})}),i.show()}})},"@VERSION@",{requires:["flickr-view","flickr-promise","fluid-droparound-view","hermes-template-search-filter-tools","search-filter-tools-css","search-helper"],langBundles:["search","common"]});
YUI.add("hermes-template-search-sort-menu",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='<div class="dropdown-link sort-menu"><p class="option-header">',(o=n.sort)?o=o.call(t,{hash:{},data:i}):(o=t.sort,o=typeof o===u?o.apply(t):o),s+=a(o)+'</p><span class="dropdown-arrow"></span></div>\n',s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/search-sort-menu",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("search-sort-menu-view",function(e){e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{initializer:function(t){var n=this,r;return this.set("sortMenuItems",t.sortMenuItems),this.searchUrl=t.searchUrl?t.searchUrl.clone():new e.SearchUrl({},this.appContext,e.SearchUrl.searchTypes.PHOTOS),r=this.searchUrl.getAPIParam(e.SearchHelper.API.sort),t.sortMenuItems&&t.sortMenuItems.length&&t.sortMenuItems.forEach(function(e){r?e.value===r&&(n.set("selectedSort",e.value),n.set("selectedSortText",e.text)):e.isDefault&&(n.set("selectedSort",e.value),n.set("selectedSortText",e.text))}),this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerHTML(this.templates("search-sort-menu")({sort:this.get("selectedSortText")})),this},activate:function(){return this.registerEventHandler(this.get("container").one(".sort-menu").on("click",this.handleSortMenu.bind(this))),this},handleSortMenu:function(t){var n=this;t.halt(),this.dropdown=new e.Views.FluidDroparound({appContext:this.appContext,showDropArrow:!0,observePageResize:!0,anchorElement:t.target.one(".dropdown-arrow"),positionFixed:!0,closeOnScroll:!0,preferBottom:!0,contentPadding:12,anchorOffsetHorizontal:t.target.get("clientWidth")-12,menuItems:this.get("sortMenuItems")}),this.dropdown.show(),this.registerEventHandler(this.dropdown.on("selected",function(t){t&&t.menuItem&&t.menuItem.value!==n.get("selectedSort")&&(n.set("selectedSort",t.menuItem.value),n.set("selectedSortText",t.menuItem.text),n.get("container").one(".sort-menu p").set("text",n.get("selectedSortText")),n.searchUrl.searchType!==e.SearchUrl.searchTypes.PHOTOS&&n.isDefaultValue()?n.searchUrl.removeAPIParam(e.SearchHelper.API.sort):n.searchUrl.setAPIParam(e.SearchHelper.API.sort,n.get("selectedSort")),n.fire("subviewViewEvent","search:urlUpdate",n.searchUrl)),n.dropdown.close()}))},isDefaultValue:function(){var e=this;return this.get("sortMenuItems").reduce(function(t,n){return t||n.isDefault&&n.value===e.get("selectedSort")},!1)}})},"@VERSION@",{requires:["flickr-view","flickr-promise","fluid-droparound-view","hermes-template-search-sort-menu","search-sort-menu-css"]});
YUI.add("hermes-template-search-color-picker",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function c(e,t){var r="",i,s;r+='\n		<li class="color-swatch',i=n["if"].call(e,e.useDarkCheckMark,{hash:{},inverse:u.noop,fn:u.program(2,h,t),data:t});if(i||i===0)r+=i;i=n["if"].call(e,e.useOutline,{hash:{},inverse:u.noop,fn:u.program(4,p,t),data:t});if(i||i===0)r+=i;i=n["if"].call(e,e.selected,{hash:{},inverse:u.noop,fn:u.program(6,d,t),data:t});if(i||i===0)r+=i;return r+='" style="background-color: #',(i=n.color)?i=i.call(e,{hash:{},data:t}):(i=e.color,i=typeof i===a?i.apply(e):i),r+=f(i)+'" data-color-code="',(i=n.colorCode)?i=i.call(e,{hash:{},data:t}):(i=e.colorCode,i=typeof i===a?i.apply(e):i),r+=f(i)+'" data-tooltip-title="',s={hash:{intlName:e.intlKey},data:t},r+=f((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+'"></li>\n	',r}function h(e,t){return" dark-check"}function p(e,t){return" outline"}function d(e,t){return" checked"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this,a="function",f=this.escapeExpression,l=n.helperMissing;s+='<ul class="color-list">\n	',o=n.each.call(t,t.colors,{hash:{},inverse:u.noop,fn:u.program(1,c,i),data:i});if(o||o===0)s+=o;return s+="\n</ul>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/search-color-picker",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("search-color-picker-view",function(e){var t=5,n=[{intlKey:"search.RED",color:"ff2000",colorCode:"0"},{intlKey:"search.DARK_ORANGE",color:"a24615",colorCode:"1"},{intlKey:"search.ORANGE",color:"ff7c00",colorCode:"2"},{intlKey:"search.PALE_PINK",color:"ff9f9c",colorCode:"b"},{intlKey:"search.LEMON_YELLOW",color:"fffa00",colorCode:"4",useDarkCheckMark:!0},{intlKey:"search.SCHOOL_BUS_YELLOW",color:"ffcf00",colorCode:"3",useDarkCheckMark:!0},{intlKey:"search.GREEN",color:"90e200",colorCode:"5"},{intlKey:"search.LIME_GREEN",color:"00ab00",colorCode:"6"},{intlKey:"search.CYAN",color:"00b2d4",colorCode:"7"},{intlKey:"search.BLUE",color:"0062c6",colorCode:"8"},{intlKey:"search.VIOLET",color:"8c20ba",colorCode:"9"},{intlKey:"search.PINK",color:"f52394",colorCode:"a"},{intlKey:"search.WHITE",color:"ffffff",colorCode:"c",useDarkCheckMark:!0,useOutline:!0},{intlKey:"search.GRAY",color:"7c7c7c",colorCode:"d"},{intlKey:"search.BLACK",color:"000000",colorCode:"e"}];e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){var r=this,i;return this.searchUrl=t.searchUrl||new e.SearchUrl({},this.appContext,e.SearchUrl.searchTypes.PHOTOS),i=this.searchUrl.getAPIParam(e.SearchHelper.API.colorCodes),this.selectedColors=i?i.split(","):[],this.colors=[],n.forEach(function(t){r.colors.push(e.merge(t,{selected:r.selectedColors.indexOf(t.colorCode)!==-1}))}),this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerHTML(this.templates("search-color-picker")({colors:this.colors})),this.updateContainerDisabledState(),this},activate:function(){return this.registerEventHandler(this.get("container").delegate("click",this.handleColorSwatchClick.bind(this),".color-swatch")),this},onParentViewEvent:function(e,t){var n=t&&t.length&&t[0];switch(n){case"search:blackandwhiteStyleSelected":this.clearSelectedColors()}},handleColorSwatchClick:function(e){var t=e.target.getData("color-code"),n=this.selectedColors.indexOf(t);e.halt();if(n===-1){if(this.isContainerDisabled())return;this.selectedColors.push(t),e.target.addClass("checked"),this.updateContainerDisabledState(),this.fire("subviewViewEvent","search:colorSelected")}else this.selectedColors.splice(n,1),e.target.removeClass("checked"),this.updateContainerDisabledState();this.updateSearchUrl()},updateContainerDisabledState:function(){this.selectedColors.length>=t?this.get("container").addClass("disabled"):this.get("container").removeClass("disabled")},isContainerDisabled:function(){return!!this.get("container").hasClass("disabled")},updateSearchUrl:function(){this.searchUrl.clearColorCodes(),this.isDefaultValue()||this.searchUrl.setAPIParam(e.SearchHelper.API.colorCodes,this.selectedColors.join(",")),this.fire("subviewViewEvent","search:urlUpdate",this.searchUrl)},isDefaultValue:function(){return!this.selectedColors||!this.selectedColors.length},clearSelectedColors:function(){this.selectedColors=[],this.colors.forEach(function(e){e.selected=0}),this.buildContainer(),this.updateSearchUrl()}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-search-color-picker","search-color-picker-css","search-helper","search-url"],langBundles:["search"]});
YUI.add("hermes-template-search-style-picker",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function c(e,t){var r="",i,s;r+='\n		<li class="style-button ',(i=n.cssClass)?i=i.call(e,{hash:{},data:t}):(i=e.cssClass,i=typeof i===u?i.apply(e):i),r+=a(i),i=n["if"].call(e,e.useDarkCheckMark,{hash:{},inverse:f.noop,fn:f.program(2,h,t),data:t});if(i||i===0)r+=i;i=n["if"].call(e,e.selected,{hash:{},inverse:f.noop,fn:f.program(4,p,t),data:t});if(i||i===0)r+=i;return r+='" data-style-value="',(i=n.value)?i=i.call(e,{hash:{},data:t}):(i=e.value,i=typeof i===u?i.apply(e):i),r+=a(i)+'" data-tooltip-title="',s={hash:{intlName:e.intlKey},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+'"></li>\n	',r}function h(e,t){return" dark-check"}function p(e,t){return" checked"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this,l=n.helperMissing;s+='<ul class="style-list">\n	',o=n.each.call(t,t.styles,{hash:{},inverse:f.noop,fn:f.program(1,c,i),data:i});if(o||o===0)s+=o;return s+="\n</ul>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/search-style-picker",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("search-style-picker-view",function(e){var t=[{intlKey:"search.BLACK_AND_WHITE",value:"blackandwhite",cssClass:"black-and-white"},{intlKey:"search.DEPTH_OF_FIELD",value:"depthoffield",cssClass:"depth-of-field"},{intlKey:"search.MINIMALIST",value:"minimalism",cssClass:"minimalist"},{intlKey:"search.PATTERNS",value:"pattern",cssClass:"patterns"}];e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(n){var r=this,i;return this.searchUrl=n.searchUrl||new e.SearchUrl({},this.appContext,e.SearchUrl.searchTypes.PHOTOS),i=this.searchUrl.getAPIParam(e.SearchHelper.API.styles),this.selectedStyles=i?i.split(","):[],this.styles=[],t.forEach(function(t){r.styles.push(e.merge(t,{selected:r.selectedStyles.indexOf(t.value)!==-1}))}),this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerHTML(this.templates("search-style-picker")({styles:this.styles})),this},activate:function(){return this.registerEventHandler(this.get("container").delegate("click",this.handleFilterClick.bind(this),".style-button")),this},onParentViewEvent:function(e,t){var n=t&&t.length&&t[0];switch(n){case"search:colorSelected":this.clearSelectedStyle("blackandwhite")}},handleFilterClick:function(e){var t=e.target.getData("style-value"),n=this.selectedStyles.indexOf(t);e.halt(),n===-1?(this.selectedStyles.push(t),e.target.addClass("checked"),t==="blackandwhite"&&this.fire("subviewViewEvent","search:blackandwhiteStyleSelected")):(this.selectedStyles.splice(n,1),e.target.removeClass("checked")),this.updateSearchUrl()},updateSearchUrl:function(){this.isDefaultValue()?this.searchUrl.removeAPIParam(e.SearchHelper.API.styles):this.searchUrl.setAPIParam(e.SearchHelper.API.styles,this.selectedStyles.join(",")),this.fire("subviewViewEvent","search:urlUpdate",this.searchUrl)},isDefaultValue:function(){return!this.selectedStyles||!this.selectedStyles.length},clearSelectedStyle:function(e){var t=this.selectedStyles.indexOf(e);t!==-1&&(this.selectedStyles.splice(t,1),this.styles.some(function(t){if(t.value===e)return t.selected=0,!0})),this.buildContainer(),this.updateSearchUrl()}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-search-style-picker","search-style-picker-css","search-helper","search-url"],langBundles:["search"]});
YUI.add("hermes-template-search-orientation-picker",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){var r="",i,s;r+='\n		<div class="orientation-button ',(i=n.cssClass)?i=i.call(e,{hash:{},data:t}):(i=e.cssClass,i=typeof i===f?i.apply(e):i),r+=l(i),i=n["if"].call(e,e.selected,{hash:{},inverse:c.noop,fn:c.program(2,d,t),data:t});if(i||i===0)r+=i;return r+='" data-orientation-value="',(i=n.value)?i=i.call(e,{hash:{},data:t}):(i=e.value,i=typeof i===f?i.apply(e):i),r+=l(i)+'" data-tooltip-title="',s={hash:{intlName:e.intlKey},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):h.call(e,"intlMessage",s)))+'" data-tooltip-prefer-bottom="true"></div>\n	',r}function d(e,t){return" checked"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;s+='<p class="option-header">',a={hash:{intlName:"search.ORIENTATION"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</p>\n<div class="orientation-list">\n	',u=n.each.call(t,t.orientations,{hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i});if(u||u===0)s+=u;return s+="\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/search-orientation-picker",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("search-orientation-picker-view",function(e){var t=[{intlKey:"search.LANDSCAPE",value:"landscape",cssClass:"landscape",selected:!0},{intlKey:"search.PORTRAIT",value:"portrait",cssClass:"portrait",selected:!0},{intlKey:"search.SQUARE",value:"square",cssClass:"square",selected:!0},{intlKey:"search.PANORAMA",value:"panorama",cssClass:"panorama",selected:!0}];e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(n){var r=this,i,s;return this.searchUrl=n.searchUrl||new e.SearchUrl({},this.appContext,e.SearchUrl.searchTypes.PHOTOS),i=this.searchUrl.getAPIParam(e.SearchHelper.API.orientation),this.selectedOrientations=[],this.orientations=[],t.forEach(function(t){s=e.merge(t),i&&(s.selected=i.indexOf(t.value)!==-1),s.selected&&r.selectedOrientations.push(s.value),r.orientations.push(s)}),this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerHTML(this.templates("search-orientation-picker")({orientations:this.orientations})),this.updateContainerDisabledState(),this},activate:function(){return this.registerEventHandler(this.get("container").delegate("click",this.handleOrientationClick.bind(this),".orientation-button")),this},handleOrientationClick:function(t){var n=t.target.getData("orientation-value"),r=this.selectedOrientations.indexOf(n);t.halt();if(r===-1)this.selectedOrientations.push(n),t.target.addClass("checked"),this.updateContainerDisabledState();else{if(this.isContainerDisabled())return;this.selectedOrientations.splice(r,1),t.target.removeClass("checked"),this.updateContainerDisabledState()}this.isDefaultValue()?this.searchUrl.removeAPIParam(e.SearchHelper.API.orientation):this.searchUrl.setAPIParam(e.SearchHelper.API.orientation,this.selectedOrientations.join(",")),this.fire("subviewViewEvent","search:urlUpdate",this.searchUrl)},updateContainerDisabledState:function(){this.selectedOrientations.length<=1?this.get("container").addClass("disabled"):this.get("container").removeClass("disabled")},isContainerDisabled:function(){return!!this.get("container").hasClass("disabled")},isDefaultValue:function(){return this.selectedOrientations&&this.selectedOrientations.length===t.length}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-search-orientation-picker","search-orientation-picker-css","search-helper","search-url"],langBundles:["search"]});
YUI.add("hermes-template-search-min-size-picker",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){var r="",i,s,o;r+='\n		<li class="size-button',i=n["if"].call(e,e.isFirst,{hash:{},inverse:c.noop,fn:c.program(2,d,t),data:t});if(i||i===0)r+=i;i=n["if"].call(e,e.isLast,{hash:{},inverse:c.noop,fn:c.program(4,v,t),data:t});if(i||i===0)r+=i;i=n["if"].call(e,e.selected,{hash:{},inverse:c.noop,fn:c.program(6,m,t),data:t});if(i||i===0)r+=i;r+='"',i=n["if"].call(e,e.value,{hash:{},inverse:c.noop,fn:c.program(8,g,t),data:t});if(i||i===0)r+=i;r+=' data-tooltip-title="',o={hash:{intlName:e.titleIntlKey},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,o):h.call(e,"intlMessage",o))),s=n["if"].call(e,e.value,{hash:{},inverse:c.noop,fn:c.program(10,y,t),data:t});if(s||s===0)r+=s;return r+='" data-tooltip-prefer-bottom="true">',o={hash:{intlName:e.intlKey},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,o):h.call(e,"intlMessage",o)))+"</li>\n	",r}function d(e,t){return" first"}function v(e,t){return" last"}function m(e,t){return" selected"}function g(e,t){var r="",i;return r+=' data-size-value="',(i=n.value)?i=i.call(e,{hash:{},data:t}):(i=e.value,i=typeof i===f?i.apply(e):i),r+=l(i)+'"',r}function y(e,t){var r="",i;return r+=" (",(i=n.value)?i=i.call(e,{hash:{},data:t}):(i=e.value,i=typeof i===f?i.apply(e):i),r+=l(i)+")",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;s+='<p class="option-header">',a={hash:{intlName:"search.MINIMUM_SIZE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</p>\n<ul class="size-list">\n	',u=n.each.call(t,t.sizes,{hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i});if(u||u===0)s+=u;return s+="\n</ul>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/search-min-size-picker",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("search-min-size-picker-view",function(e){var t=[{intlKey:"search.SMALL_SHORT",titleIntlKey:"search.SMALL_SHOW_ALL_SIZES",selected:!0},{intlKey:"search.MEDIUM_SHORT",titleIntlKey:"search.MEDIUM",value:"640"},{intlKey:"search.LARGE_SHORT",titleIntlKey:"search.LARGE",value:"1024"}];e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(n){var r=this,i,s,o,u;return this.searchUrl=n.searchUrl||new e.SearchUrl({},this.appContext,e.SearchUrl.searchTypes.PHOTOS),i=this.searchUrl.getAPIParam(e.SearchHelper.API.dimensionSearchMode),s=this.searchUrl.getAPIParam(e.SearchHelper.API.height),o=this.searchUrl.getAPIParam(e.SearchHelper.API.width),this.sizes=[],t.forEach(function(t){u=e.merge(t),i&&s&&o&&(u.selected=t.value&&s===t.value&&o===t.value&&i==="min"),u.selected&&r.set("selectedSize",u.value),r.sizes.push(u)}),this.sizes[0].isFirst=!0,this.sizes[this.sizes.length-1].isLast=!0,this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerHTML(this.templates("search-min-size-picker")({sizes:this.sizes})),this},activate:function(){return this.registerEventHandler(this.get("container").delegate("click",this.handleSizeClick.bind(this),".size-button")),this},handleSizeClick:function(t){var n=t.target.getData("size-value");t.halt(),this.get("selectedSize")!==n&&(this.set("selectedSize",n),this.get("container").one(".size-button.selected").removeClass("selected"),t.target.addClass("selected"),!this.get("selectedSize")||this.isDefaultValue()?(this.searchUrl.removeAPIParam(e.SearchHelper.API.dimensionSearchMode),this.searchUrl.removeAPIParam(e.SearchHelper.API.height),this.searchUrl.removeAPIParam(e.SearchHelper.API.width)):(this.searchUrl.setAPIParam(e.SearchHelper.API.dimensionSearchMode,"min"),this.searchUrl.setAPIParam(e.SearchHelper.API.height,this.get("selectedSize")),this.searchUrl.setAPIParam(e.SearchHelper.API.width,this.get("selectedSize"))),this.fire("subviewViewEvent","search:urlUpdate",this.searchUrl))},isDefaultValue:function(){return!this.get("selectedSize")}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-search-min-size-picker","search-min-size-picker-css","search-helper","search-url"],langBundles:["search"]});
YUI.add("hermes-template-search-content-picker",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){var r="",i,s;r+='\n		<li class="content-button',i=n["if"].call(e,e.selected,{hash:{},inverse:c.noop,fn:c.program(2,d,t),data:t});if(i||i===0)r+=i;r+='"',i=n["if"].call(e,e.value,{hash:{},inverse:c.noop,fn:c.program(4,v,t),data:t});if(i||i===0)r+=i;return r+=' data-tooltip-title="',s={hash:{intlName:e.titleIntlKey},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):h.call(e,"intlMessage",s)))+'" data-tooltip-prefer-bottom="true">',s={hash:{intlName:e.intlKey},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):h.call(e,"intlMessage",s)))+"</li>\n	",r}function d(e,t){return" checked"}function v(e,t){var r="",i;return r+=' data-content-value="',(i=n.value)?i=i.call(e,{hash:{},data:t}):(i=e.value,i=typeof i===f?i.apply(e):i),r+=l(i)+'"',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;s+='<p class="option-header">',a={hash:{intlName:"search.CONTENT"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</p>\n<ul class="content-list">\n	',u=n.each.call(t,t.contents,{hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i});if(u||u===0)s+=u;return s+="\n</ul>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/search-content-picker",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("search-content-picker-view",function(e){var t=[{intlKey:"search.PHOTOS",titleIntlKey:"search.PHOTOS",value:"photos",selected:!0},{intlKey:"search.VIDEOS",titleIntlKey:"search.VIDEOS",value:"videos",selected:!0}];e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(n){var r=this,i,s;return this.searchUrl=n.searchUrl||new e.SearchUrl({},this.appContext,e.SearchUrl.searchTypes.PHOTOS),i=this.searchUrl.getAPIParam(e.SearchHelper.API.mediaType),this.selectedContents=[],this.contents=[],t.forEach(function(t){s=e.merge(t),i&&(s.selected=i===t.value||i==="all"),s.selected&&r.selectedContents.push(s.value),r.contents.push(s)}),this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerHTML(this.templates("search-content-picker")({contents:this.contents})),this.updateContainerDisabledState(),this},activate:function(){return this.registerEventHandler(this.get("container").delegate("click",this.handleContentClick.bind(this),".content-button")),this},handleContentClick:function(t){var n=t.target.getData("content-value"),r=this.selectedContents.indexOf(n);t.halt();if(r===-1)this.selectedContents.push(n),t.target.addClass("checked"),this.updateContainerDisabledState();else{if(this.isContainerDisabled())return;this.selectedContents.splice(r,1),t.target.removeClass("checked"),this.updateContainerDisabledState()}!this.selectedContents.length||this.isDefaultValue()?this.searchUrl.removeAPIParam(e.SearchHelper.API.mediaType):this.searchUrl.setAPIParam(e.SearchHelper.API.mediaType,this.selectedContents[0]),this.fire("subviewViewEvent","search:urlUpdate",this.searchUrl)},updateContainerDisabledState:function(){this.selectedContents.length<=1?this.get("container").addClass("disabled"):this.get("container").removeClass("disabled")},isContainerDisabled:function(){return!!this.get("container").hasClass("disabled")},isDefaultValue:function(){return this.selectedContents&&this.selectedContents.length===t.length}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-search-content-picker","search-content-picker-css","search-helper","search-url"],langBundles:["search"]});
YUI.add("hermes-template-search-search-in-picker",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){var r="",i,s;r+='\n		<li class="search-in-button',i=n["if"].call(e,e.isFirst,{hash:{},inverse:c.noop,fn:c.program(2,d,t),data:t});if(i||i===0)r+=i;i=n["if"].call(e,e.isLast,{hash:{},inverse:c.noop,fn:c.program(4,v,t),data:t});if(i||i===0)r+=i;i=n["if"].call(e,e.selected,{hash:{},inverse:c.noop,fn:c.program(6,m,t),data:t});if(i||i===0)r+=i;r+='"',i=n["if"].call(e,e.value,{hash:{},inverse:c.noop,fn:c.program(8,g,t),data:t});if(i||i===0)r+=i;return r+=' data-tooltip-title="',s={hash:{intlName:e.titleIntlKey},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):h.call(e,"intlMessage",s)))+'" data-tooltip-prefer-bottom="true">',s={hash:{intlName:e.intlKey},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):h.call(e,"intlMessage",s)))+"</li>\n	",r}function d(e,t){return" first"}function v(e,t){return" last"}function m(e,t){return" selected"}function g(e,t){var r="",i;return r+=' data-search-in-value="',(i=n.value)?i=i.call(e,{hash:{},data:t}):(i=e.value,i=typeof i===f?i.apply(e):i),r+=l(i)+'"',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;s+='<p class="option-header">',a={hash:{intlName:"search.SEARCH_IN"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</p>\n<ul class="search-in-list">\n	',u=n.each.call(t,t.searchIns,{hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i});if(u||u===0)s+=u;return s+="\n</ul>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/search-search-in-picker",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("search-search-in-picker-view",function(e){var t=[{intlKey:"search.ALL",titleIntlKey:"search.FULL_TEXT",value:"text",selected:!0},{intlKey:"search.TAGS",titleIntlKey:"search.TAGS_ONLY",value:"tags"}];e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(n){var r=this,i,s;return this.searchUrl=n.searchUrl||new e.SearchUrl({},this.appContext,e.SearchUrl.searchTypes.PHOTOS),i=this.searchUrl.getAPIParam(e.SearchHelper.API.tags),this.searchIns=[],t.forEach(function(t){s=e.merge(t);if(i||i==="")s.selected=s.value==="tags";s.selected&&r.set("selectedSearchIn",s.value),r.searchIns.push(s)}),this.searchIns[0].isFirst=!0,this.searchIns[this.searchIns.length-1].isLast=!0,this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerHTML(this.templates("search-search-in-picker")({searchIns:this.searchIns})),this},activate:function(){return this.registerEventHandler(this.get("container").delegate("click",this.handleSearchInClick.bind(this),".search-in-button")),this},handleSearchInClick:function(t){var n=t.target.getData("search-in-value"),r=this.searchUrl.getSearchTerm();t.halt(),this.get("selectedSearchIn")!==n&&(this.set("selectedSearchIn",n),this.get("container").one(".search-in-button.selected").removeClass("selected"),t.target.addClass("selected"),this.searchUrl.removeAPIParam(e.SearchHelper.API.text),this.searchUrl.removeAPIParam(e.SearchHelper.API.tags),!this.get("selectedSearchIn")||this.isDefaultValue()?this.searchUrl.setAPIParam(e.SearchHelper.API.text,r):this.searchUrl.setAPIParam(e.SearchHelper.API.tags,r),this.fire("subviewViewEvent","search:urlUpdate",this.searchUrl))},isDefaultValue:function(){return this.get("selectedSearchIn")==="text"}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-search-search-in-picker","search-search-in-picker-css"],langBundles:["search"]});
YUI.add("hermes-template-search-date-picker",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=n.helperMissing;return s+='<div class="dropdown-link date-mode-menu"><p class="option-header">',(o=n.dateMode)?o=o.call(t,{hash:{},data:i}):(o=t.dateMode,o=typeof o===a?o.apply(t):o),s+=f(o)+'</p><span class="dropdown-arrow"></span></div>\n<div class="date-inputs">\n  <div class="date-input-container">\n    <label>',u={hash:{intlName:"search.FROM"},data:i},s+=f((o=n.intlMessage||t.intlMessage,o?o.call(t,u):l.call(t,"intlMessage",u)))+'</label>\n    <input type="text" id="date-from" class="date-picker" placeholder="',u={hash:{intlName:"pika-day.DATE_FORMAT"},data:i},s+=f((o=n.intlMessage||t.intlMessage,o?o.call(t,u):l.call(t,"intlMessage",u)))+'" />\n  </div>\n  <div class="date-input-container">\n    <label>',u={hash:{intlName:"search.TO"},data:i},s+=f((o=n.intlMessage||t.intlMessage,o?o.call(t,u):l.call(t,"intlMessage",u)))+'</label>\n    <input type="text" id="date-to" class="date-picker" placeholder="',u={hash:{intlName:"pika-day.DATE_FORMAT"},data:i},s+=f((o=n.intlMessage||t.intlMessage,o?o.call(t,u):l.call(t,"intlMessage",u)))+'" />\n  </div>\n</div>\n',s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/search-date-picker",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("search-date-picker-view",function(e){var t=[{intlKey:"search.DATE_TAKEN",value:"taken",isDefault:!0},{intlKey:"search.DATE_UPLOADED",value:"upload"}],n=1826;e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(r){var i=this,s,o,u,a,f;this.searchUrl=r.searchUrl||new e.SearchUrl({},this.appContext,e.SearchUrl.searchTypes.PHOTOS),s=this.searchUrl.getAPIParam(e.SearchHelper.API.minTakenDate),o=this.searchUrl.getAPIParam(e.SearchHelper.API.maxTakenDate),u=this.searchUrl.getAPIParam(e.SearchHelper.API.minUploadDate),a=this.searchUrl.getAPIParam(e.SearchHelper.API.maxUploadDate),this.dateModes=[],t.forEach(function(t){f=e.merge(t,{text:i.intlMessage({intlName:t.intlKey})}),s||o?f.value==="taken"&&(i.set("selectedDateMode",f.value),i.set("selectedDateModeText",f.text)):u||a?f.value==="upload"&&(i.set("selectedDateMode",f.value),i.set("selectedDateModeText",f.text)):f.isDefault&&(i.set("selectedDateMode",f.value),i.set("selectedDateModeText",f.text)),i.dateModes.push(f)});if(s||o)this.set("selectedDateFrom",s),this.set("selectedDateTo",o);else if(u||a)this.set("selectedDateFrom",u),this.set("selectedDateTo",a);return this.dateIntl={previousMonth:this.intlMessage({intlName:"pika-day.PREVIOUS_MONTH"}),nextMonth:this.intlMessage({intlName:"pika-day.NEXT_MONTH"})},this.dateIntl.weekdays=[this.intlMessage({intlName:"pika-day.SUNDAY"}),this.intlMessage({intlName:"pika-day.MONDAY"}),this.intlMessage({intlName:"pika-day.TUESDAY"}),this.intlMessage({intlName:"pika-day.WEDNESDAY"}),this.intlMessage({intlName:"pika-day.THURSDAY"}),this.intlMessage({intlName:"pika-day.FRIDAY"}),this.intlMessage({intlName:"pika-day.SATURDAY"})],this.dateIntl.weekdaysShort=[this.intlMessage({intlName:"pika-day.SUNDAY_SHORT"}),this.intlMessage({intlName:"pika-day.MONDAY_SHORT"}),this.intlMessage({intlName:"pika-day.TUESDAY_SHORT"}),this.intlMessage({intlName:"pika-day.WEDNESDAY_SHORT"}),this.intlMessage({intlName:"pika-day.THURSDAY_SHORT"}),this.intlMessage({intlName:"pika-day.FRIDAY_SHORT"}),this.intlMessage({intlName:"pika-day.SATURDAY_SHORT"})],this.dateIntl.months=[this.intlMessage({intlName:"pika-day.JANUARY"}),this.intlMessage({intlName:"pika-day.FEBRUARY"}),this.intlMessage({intlName:"pika-day.MARCH"}),this.intlMessage({intlName:"pika-day.APRIL"}),this.intlMessage({intlName:"pika-day.MAY"}),this.intlMessage({intlName:"pika-day.JUNE"}),this.intlMessage({intlName:"pika-day.JULY"}),this.intlMessage({intlName:"pika-day.AUGUST"}),this.intlMessage({intlName:"pika-day.SEPTEMBER"}),this.intlMessage({intlName:"pika-day.OCTOBER"}),this.intlMessage({intlName:"pika-day.NOVEMBER"}),this.intlMessage({intlName:"pika-day.DECEMBER"})],this.basePikadayOptions={i18n:this.dateIntl,position:"bottom",reposition:!1,format:this.intlMessage({intlName:"pika-day.DATE_FORMAT"}),yearRange:[n,(new Date).getFullYear()],onSelect:this.handleDateChange.bind(this)},this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerHTML(this.templates("search-date-picker")({dateMode:this.get("selectedDateModeText")})),this},activate:function(){return this.setupDatePickers(),this.registerEventHandler(this.get("container").one(".date-mode-menu").on("click",this.handleDateModeMenuClick.bind(this))),this.registerEventHandler(this.get("container").delegate("change",this.handleDateInputFieldChange.bind(this),".date-picker")),this},setupDatePickers:function(){var t=this.get("selectedDateFrom"),n=this.get("selectedDateTo");this.datePickers={},this.datePickers.from=new e.Pikaday(e.merge(this.basePikadayOptions,{field:this.get("container").one("#date-from.date-picker").getDOMNode(),defaultDate:t?new Date(parseInt(t)*1e3):null,setDefaultDate:!!t})),this.datePickers.to=new e.Pikaday(e.merge(this.basePikadayOptions,{field:this.get("container").one("#date-to.date-picker").getDOMNode(),defaultDate:n?new Date(parseInt(n)*1e3):null,setDefaultDate:!!n}))},handleDateModeMenuClick:function(t){var n=this;t.halt(),this.dropdown=new e.Views.FluidDroparound({appContext:this.appContext,showDropArrow:!0,observePageResize:!0,anchorElement:t.target.one(".dropdown-arrow"),positionFixed:!0,closeOnScroll:!0,contentPadding:12,anchorOffsetHorizontal:t.target.get("clientWidth")-12,menuItems:this.dateModes}),this.dropdown.show(),this.registerEventHandler(this.dropdown.on("selected",function(e){e&&e.menuItem&&e.menuItem.value!==n.get("selectedDateMode")&&(n.set("selectedDateMode",e.menuItem.value),n.set("selectedDateModeText",e.menuItem.text),n.get("container").one(".date-mode-menu p").set("text",n.get("selectedDateModeText")),n.isDefaultValue()||n.processUpdate()),n.dropdown.close()}))},handleDateInputFieldChange:function(e){e.halt(),e.target.get("value")||this.handleDateChange()},handleDateChange:function(){var e=this.datePickers.from.toString("X"),t;this.datePickers.to.getDate()&&(t=this.datePickers.to.getMoment().add({hours:23,minutes:59,seconds:59}).format("X"));if(e!==this.get("selectedDateFrom")||t!==this.get("selectedDateTo"))this.set("selectedDateFrom",e),this.set("selectedDateTo",t),this.processUpdate()},processUpdate:function(){var t=this.get("selectedDateMode"),n=this.get("selectedDateFrom"),r=this.get("selectedDateTo"),i=t==="upload"?e.SearchHelper.API.minUploadDate:e.SearchHelper.API.minTakenDate,s=t==="upload"?e.SearchHelper.API.maxUploadDate:e.SearchHelper.API.maxTakenDate;this.searchUrl.removeAPIParam(e.SearchHelper.API.minTakenDate),this.searchUrl.removeAPIParam(e.SearchHelper.API.maxTakenDate),this.searchUrl.removeAPIParam(e.SearchHelper.API.minUploadDate),this.searchUrl.removeAPIParam(e.SearchHelper.API.maxUploadDate),this.isDefaultValue()||(n&&this.searchUrl.setAPIParam(i,n),r&&this.searchUrl.setAPIParam(s,r)),this.fire("subviewViewEvent","search:urlUpdate",this.searchUrl)},isDefaultValue:function(){return!this.get("selectedDateFrom")&&!this.get("selectedDateTo")}})},"@VERSION@",{requires:["flickr-view","flickr-promise","fluid-droparound-view","hermes-template-search-date-picker"
,"search-date-picker-css","search-helper","search-url"],langBundles:["search","pika-day"]});
YUI.add("hermes-template-search-slender-advanced-panel",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){var r="",i,s,o;r+='\n	<div class="advanced-panel">\n\n		<div class="fluid-centered">\n			<div class="quick-filter">\n\n				',o={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e["search-color-picker-view"],o):f.call(e,"outlet",e["search-color-picker-view"],o)))+"\n\n				",o={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e["search-style-picker-view"],o):f.call(e,"outlet",e["search-style-picker-view"],o)))+'\n\n				<div class="advanced-toggle">\n					<a class=\'tertiary\' title="',o={hash:{intlName:"search.TOGGLE_ADVANCED"},data:t},r+=l((i=n.intlHTMLMessage||e.intlHTMLMessage,i?i.call(e,o):f.call(e,"intlHTMLMessage",o)))+'" href="#" data-track="search-toggle-advanced">',o={hash:{intlName:"search.ADVANCED"},data:t},r+=l((i=n.intlHTMLMessage||e.intlHTMLMessage,i?i.call(e,o):f.call(e,"intlHTMLMessage",o)))+'<span class="advanced-icon',s=n["if"].call(e,e.collapseAdvancedOptions,{hash:{},inverse:c.noop,fn:c.program(2,d,t),data:t});if(s||s===0)r+=s;r+='"></span></a>\n				</div>\n\n			</div>\n		</div>\n\n		<div class="advanced-options fluid-centered',s=n["if"].call(e,e.collapseAdvancedOptions,{hash:{},inverse:c.noop,fn:c.program(2,d,t),data:t});if(s||s===0)r+=s;return r+='">\n\n			',o={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e["search-orientation-picker-view"],o):f.call(e,"outlet",e["search-orientation-picker-view"],o)))+"\n\n			",o={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e["search-min-size-picker-view"],o):f.call(e,"outlet",e["search-min-size-picker-view"],o)))+"\n\n			",o={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e["search-date-picker-view"],o):f.call(e,"outlet",e["search-date-picker-view"],o)))+"\n\n			",o={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e["search-content-picker-view"],o):f.call(e,"outlet",e["search-content-picker-view"],o)))+"\n\n			",o={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e["search-search-in-picker-view"],o):f.call(e,"outlet",e["search-search-in-picker-view"],o)))+"\n\n		</div>\n\n	</div>\n",r}function d(e,t){return" collapsed"}function v(e,t){var r="",i,s;r+='\n			<div class="inactive-groups-toggle">\n				<input id="inactive-groups-toggle-checkbox" type="checkbox"',i=n["if"].call(e,e.isInactiveGroupsToggleChecked,{hash:{},inverse:c.noop,fn:c.program(5,m,t),data:t});if(i||i===0)r+=i;return r+=' />\n				<label for="inactive-groups-toggle-checkbox">',s={hash:{intlName:"search.HIDE_INACTIVE_GROUPS"},data:t},r+=l((i=n.intlHTMLMessage||e.intlHTMLMessage,i?i.call(e,s):f.call(e,"intlHTMLMessage",s)))+"</label>\n			</div>\n		",r}function m(e,t){return" checked"}function g(e,t){var r="",i,s;return r+="\n			",s={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e["search-sort-menu-view"],s):f.call(e,"outlet",e["search-sort-menu-view"],s)))+"\n		",r}function y(e,t){var r="",i;r+='\n			<div class="layout-toggles">\n				',i=n["if"].call(e,e.showTilesButton,{hash:{},inverse:c.program(13,E,t),fn:c.program(10,b,t),data:t});if(i||i===0)r+=i;return r+="\n			</div>\n		",r}function b(e,t){var r="",i,s,o;r+='\n					<button data-layout-style="',(i=n.thumbsLayoutButtonData)?i=i.call(e,{hash:{},data:t}):(i=e.thumbsLayoutButtonData,i=typeof i===h?i.apply(e):i),r+=l(i)+'" class="layout thumbs',i=n["if"].call(e,e.isThumbsLayout,{hash:{},inverse:c.noop,fn:c.program(11,w,t),data:t});if(i||i===0)r+=i;r+='" data-track="search-layout-thumbs" title="',o={hash:{intlName:"search.THUMBNAIL_VIEW"},data:t},r+=l((i=n.intlHTMLMessage||e.intlHTMLMessage,i?i.call(e,o):f.call(e,"intlHTMLMessage",o)))+'"></button>\n					<button data-layout-style="',(s=n.justifiedLayoutButtonData)?s=s.call(e,{hash:{},data:t}):(s=e.justifiedLayoutButtonData,s=typeof s===h?s.apply(e):s),r+=l(s)+'" class="layout justified',s=n["if"].call(e,e.isJustifiedLayout,{hash:{},inverse:c.noop,fn:c.program(11,w,t),data:t});if(s||s===0)r+=s;r+='" data-track="search-layout-justified" title="',o={hash:{intlName:"search.JUSTIFIED_VIEW"},data:t},r+=l((i=n.intlHTMLMessage||e.intlHTMLMessage,i?i.call(e,o):f.call(e,"intlHTMLMessage",o)))+'"></button>\n					<button data-layout-style="',(s=n.tilesLayoutButtonData)?s=s.call(e,{hash:{},data:t}):(s=e.tilesLayoutButtonData,s=typeof s===h?s.apply(e):s),r+=l(s)+'" class="layout tiles',s=n["if"].call(e,e.isTilesLayout,{hash:{},inverse:c.noop,fn:c.program(11,w,t),data:t});if(s||s===0)r+=s;return r+='" data-track="search-layout-tiles" title="',o={hash:{intlName:"search.TILE_VIEW"},data:t},r+=l((i=n.intlHTMLMessage||e.intlHTMLMessage,i?i.call(e,o):f.call(e,"intlHTMLMessage",o)))+'"></button>\n				',r}function w(e,t){return" selected"}function E(e,t){var r="",i,s,o;r+='\n					<button data-layout-style="',(i=n.justifiedLayoutButtonData)?i=i.call(e,{hash:{},data:t}):(i=e.justifiedLayoutButtonData,i=typeof i===h?i.apply(e):i),r+=l(i)+'" class="layout justified',i=n["if"].call(e,e.isJustifiedLayout,{hash:{},inverse:c.noop,fn:c.program(11,w,t),data:t});if(i||i===0)r+=i;r+='" data-track="search-layout-justified" title="',o={hash:{intlName:"search.JUSTIFIED_VIEW"},data:t},r+=l((i=n.intlHTMLMessage||e.intlHTMLMessage,i?i.call(e,o):f.call(e,"intlHTMLMessage",o)))+'"></button>\n					<button data-layout-style="',(s=n.thumbsLayoutButtonData)?s=s.call(e,{hash:{},data:t}):(s=e.thumbsLayoutButtonData,s=typeof s===h?s.apply(e):s),r+=l(s)+'" class="layout thumbs',s=n["if"].call(e,e.isThumbsLayout,{hash:{},inverse:c.noop,fn:c.program(11,w,t),data:t});if(s||s===0)r+=s;return r+='" data-track="search-layout-thumbs" title="',o={hash:{intlName:"search.THUMBNAIL_VIEW"},data:t},r+=l((i=n.intlHTMLMessage||e.intlHTMLMessage,i?i.call(e,o):f.call(e,"intlHTMLMessage",o)))+'"></button>\n				',r}function S(e,t){var r="",i,s;return r+='\n		<div class="filters">\n			',s={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e["search-filter-tools-view"],s):f.call(e,"outlet",e["search-filter-tools-view"],s)))+"\n		</div>\n	",r}this.compilerInfo=
[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f=n.helperMissing,l=this.escapeExpression,c=this,h="function";o=n.unless.call(t,t.showToolbarOnly,{hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i});if(o||o===0)s+=o;s+='\n\n<div class="tool-bar fluid-centered">\n\n	<div class="tools">\n		',o=n["if"].call(t,t.showInactiveGroupsToggle,{hash:{},inverse:c.noop,fn:c.program(4,v,i),data:i});if(o||o===0)s+=o;s+="\n\n		",a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["search-camera-settings-view"],a):f.call(t,"outlet",t["search-camera-settings-view"],a)))+"\n\n		",u=n["if"].call(t,t.showSortMenu,{hash:{},inverse:c.noop,fn:c.program(7,g,i),data:i});if(u||u===0)s+=u;s+="\n\n		",u=n["if"].call(t,t.showLayoutToggles,{hash:{},inverse:c.noop,fn:c.program(9,y,i),data:i});if(u||u===0)s+=u;s+="\n	</div>\n\n	",u=n["if"].call(t,t.showFilterMenus,{hash:{},inverse:c.noop,fn:c.program(15,S,i),data:i});if(u||u===0)s+=u;return s+="\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/search-slender-advanced-panel",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("search-slender-advanced-panel-view",function(e){var t=300,n="search-advanced-panel-state";e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){var n=t.modelParams&&t.modelParams.apiParams?e.merge(t.modelParams.apiParams):{};return this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this.searchUrl=new e.SearchUrl(n,this.appContext,t.searchType),t.searchUrl=this.searchUrl,this.set("areAdvancedOptionsVisible",this.getStoredAdvancedOptionsState()),this.set("showToolbarOnly",t.showToolbarOnly),this.set("showFilterMenus",t.showTools),this.set("showInactiveGroupToggle",t.showInactiveToggle),this.set("showSortMenu",t.showSort),this.set("showLayoutToggles",t.showTools),this.set("showInactiveGroupsToggle",t.showInactiveToggle),this.set("isInactiveGroupsToggleChecked",this.searchUrl.getAPIParam(e.SearchHelper.GROUPS_SEARCH_API.filterInactive)!=="0"),this.set("layoutStyle",t.viewType||e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.justified),this},subviewConfig:{"search-filter-tools-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-sort-menu-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-color-picker-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"search-style-picker-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"search-orientation-picker-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-min-size-picker-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-date-picker-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-search-in-picker-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-content-picker-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-camera-settings-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,disabled:function(){return!this.appContext.flipper.isFlipped("enable-exposure-search")}}},loadState:function(){var t=this,n=[];return this.appContext.getViewer().signedIn&&n.push(this.appContext.getModel("person-preferences-models",this.appContext.getViewer().nsid).then(function(e){t.set("viewerPrefsModel",e)})),e.Promise.all(n)},buildContainer:function(){return this.setContainerHTML(this.templates("search-slender-advanced-panel")({collapseAdvancedOptions:!this.get("areAdvancedOptionsVisible"),showToolbarOnly:this.get("showToolbarOnly"),showFilterMenus:this.get("showFilterMenus"),showInactiveGroupToggle:this.get("showInactiveGroupToggle"),showSortMenu:this.get("showSortMenu"),showLayoutToggles:this.get("showLayoutToggles"),showInactiveGroupsToggle:this.get("showInactiveGroupsToggle"),showTilesButton:this.appContext.flipper.isFlipped("search-tiles"),isInactiveGroupsToggleChecked:this.get("isInactiveGroupsToggleChecked"),justifiedLayoutButtonData:e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.justified,thumbsLayoutButtonData:e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.thumbs,tilesLayoutButtonData:e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.tiles,isJustifiedLayout:this.get("layoutStyle")===e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.justified,isThumbsLayout:this.get("layoutStyle")===e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.thumbs,isTilesLayout:this.get("layoutStyle")===e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.tiles,"search-color-picker-view":this.subviews["search-color-picker-view"].get("container"),"search-style-picker-view":this.subviews["search-style-picker-view"].get("container"),"search-orientation-picker-view":this.subviews["search-orientation-picker-view"].get("container"),"search-min-size-picker-view":this.subviews["search-min-size-picker-view"].get("container"),"search-date-picker-view":this.subviews["search-date-picker-view"].get("container"),"search-content-picker-view":this.subviews["search-content-picker-view"].get("container"),"search-search-in-picker-view":this.subviews["search-search-in-picker-view"].get("container"),"search-sort-menu-view":this.subviews["search-sort-menu-view"].get("container"),"search-filter-tools-view":this.subviews["search-filter-tools-view"].get("container"),"search-camera-settings-view":this.subviews["search-camera-settings-view"]?this.subviews["search-camera-settings-view"].get("container"):""})),this},activate:function(){var e=this.get("container");return this.get("showToolbarOnly")||this.registerEventHandler(e.one(".advanced-toggle").on("click",this.handleAdvancedToggleClick.bind(this))),this.get("showLayoutToggles")&&this.registerEventHandler(e.delegate("click",this.handleLayoutToggleClick.bind(this),".layout")),this.get("showInactiveGroupsToggle")&&this.registerEventHandler(e.one("#inactive-groups-toggle-checkbox").on("change",this.handleInactiveGroupsToggleChange.bind(this))),this.registerEventHandler(e.delegate("mouseenter",this.handleTooltipElemMouseEnter.bind(this),"[data-tooltip-title]")),this.registerEventHandler(e.delegate("mouseleave",this.handleTooltipElemMouseLeave.bind(this),"[data-tooltip-title]")),this},onSubviewEvent:function(e,t){var n=t&&t.length&&t[0];switch(n){case"search:urlUpdate":t[1]&&(this.searchUrl=t[1],this.fire("subviewViewEvent","search:dirty"),this.appContext.flapp.navigate(this.searchUrl.getURL()));break;case"search:blackandwhiteStyleSelected":case"search:colorSelected":this.fire("parentViewEvent",n)}},handleLayoutToggleClick:function(e){var t=this.get("container"),n,r;e.preventDefault(),n=e.target.getData("layout-style"),n!==this.get("layoutStyle")&&(r=t.one(".layout.selected"),r&&r.removeClass("selected"),e.target.addClass("selected"),this.set("layoutStyle",n),this.get("viewerPrefsModel")&&(this.get("viewerPrefsModel").setValue("unifiedSearchViewPref",this.get("layoutStyle")),this.get("viewerPrefsModel").remoteUpdate()),this.fire("subviewViewEvent","search:layoutChange",this.get("layoutStyle")))},handleAdvancedToggleClick:function(t){var n=this.get
("container"),r=n.one(".advanced-options"),i=this;t.preventDefault(),n.one(".advanced-icon").toggleClass("collapsed"),r.toggleClass("collapsed"),this.set("areAdvancedOptionsVisible",!this.get("areAdvancedOptionsVisible")),this.storeAdvancedOptionsState(this.get("areAdvancedOptionsVisible")),this.fire("subviewViewEvent","search:startAdvancedPanelTransition",this.get("areAdvancedOptionsVisible")),e.flutil.onTransitionEnd(r,function(){i.fire("subviewViewEvent","search:finishAdvancedPanelTransition",i.get("areAdvancedOptionsVisible"))})},handleInactiveGroupsToggleChange:function(t){t.halt(),t.target.get("checked")?this.searchUrl.removeAPIParam(e.SearchHelper.GROUPS_SEARCH_API.filterInactive):this.searchUrl.setAPIParam(e.SearchHelper.GROUPS_SEARCH_API.filterInactive,"0"),this.appContext.flapp.navigate(this.searchUrl.getURL())},handleTooltipElemMouseEnter:function(n){var r=n.target.getData("tooltip-title"),i=this;n.halt(),this.tooltipDroparound&&this.tooltipDroparound.close(),clearTimeout(this.tooltipHoverTimer),this.isHovering=!0,this.tooltipHoverTimer=setTimeout(function(){i.isHovering&&(i.tooltipDroparound=new e.Views.FluidDroparound({appContext:i.appContext,showDropArrow:!0,dismissOnOverlayClick:!1,dismissOnActionClick:!1,observePageResize:!0,anchorElement:n.target,positionFixed:!0,closeOnScroll:!0,hideModalOverlay:!0,invisibleOverlay:!0,autoSizeToContent:!0,useAnchorOffsetSize:!0,horizCenterToAnchor:!0,preferBottom:n.target.getData("tooltip-prefer-bottom"),classList:"advanced-panel-tooltip",textMessage:r}),i.tooltipDroparound.show())},t)},handleTooltipElemMouseLeave:function(e){e.halt(),this.isHovering=!1,this.tooltipDroparound&&this.tooltipDroparound.close()},getStoredAdvancedOptionsState:function(){var t;return YUI.Env.isServer||(e.SearchUrl.isSearchUrl(this.appContext.getPreviousURL())?t=e.AttributeHelpers.coerceBoolean(e.StorageHelper.getItem(n,!0)):e.StorageHelper.remove(n,!0)),t||!1},storeAdvancedOptionsState:function(t){YUI.Env.isServer||e.StorageHelper.setItem(n,t,!0)},beforeDestroy:function(){this.detachRegisteredEvents(),clearTimeout(this.tooltipHoverTimer),this.isHovering=!1,this.tooltipDroparound&&this.tooltipDroparound.close()}})},"@VERSION@",{requires:["flickr-view","flickr-promise","search-filter-tools-view","search-sort-menu-view","search-color-picker-view","search-style-picker-view","search-orientation-picker-view","search-min-size-picker-view","search-content-picker-view","search-search-in-picker-view","search-date-picker-view","hermes-template-search-slender-advanced-panel","search-slender-advanced-panel-css","attribute-helpers","storage-helper","flutil","person-preferences-models"],optionalRequires:["pika-day"],langBundles:["search","pika-day","common"]});
